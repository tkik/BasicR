<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BasicR">
<title>Statistics • BasicR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Statistics">
<meta property="og:description" content="BasicR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BasicR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/R_data_types.html">R Data types</a>
    <a class="dropdown-item" href="../articles/S4_classes.html">S4 classes</a>
    <a class="dropdown-item" href="../articles/S4_classes_exercises.html">S4 classes, exercises</a>
    <a class="dropdown-item" href="../articles/Statistics.html">Statistics</a>
    <a class="dropdown-item" href="../articles/Statstics_solutions.html">Statistics_solutions</a>
    <a class="dropdown-item" href="../articles/assignment.html">Assignment</a>
    <a class="dropdown-item" href="../articles/basic_functions.html">Basic functions</a>
    <a class="dropdown-item" href="../articles/control_structures.html">Control structures</a>
    <a class="dropdown-item" href="../articles/data_cleaning.html">Data cleaning with Tidyverse</a>
    <a class="dropdown-item" href="../articles/data_cleaning_solutions.html">Data cleaning, solutions</a>
    <a class="dropdown-item" href="../articles/data_types_exercises.html">Data types, exercises</a>
    <a class="dropdown-item" href="../articles/data_types_exercises_solutions.html">Data types, solutions</a>
    <a class="dropdown-item" href="../articles/enrichment.html">Enrichment analysis</a>
    <a class="dropdown-item" href="../articles/exercises_control_exercises.html">Control structures, exercises</a>
    <a class="dropdown-item" href="../articles/exercises_control_solutions.html">Control structures, solutions</a>
    <a class="dropdown-item" href="../articles/functions_exercises.html">Functions, exercises</a>
    <a class="dropdown-item" href="../articles/functions_exercises_solutions.html">Functions, solutions</a>
    <a class="dropdown-item" href="../articles/ggplot2.html">GGplot2</a>
    <a class="dropdown-item" href="../articles/ggplot_solutions.html">GGplot solutions</a>
    <a class="dropdown-item" href="../articles/intro.html">Course introduction</a>
    <a class="dropdown-item" href="../articles/methylation_analysisRmd.html">DNA methylation</a>
    <a class="dropdown-item" href="../articles/r_functions.html">Functions, useful packages</a>
    <a class="dropdown-item" href="../articles/references.html">References</a>
    <a class="dropdown-item" href="../articles/reproducible.html">Reproducible programming</a>
    <a class="dropdown-item" href="../articles/reproducible_solutions.html">Reproducible programming, exercises</a>
    <a class="dropdown-item" href="../articles/resources.html">Resources</a>
    <a class="dropdown-item" href="../articles/set_up_git.html">Set up git</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tkik/BasicR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="Statistics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Statistics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tkik/BasicR/blob/HEAD/vignettes/Statistics.Rmd" class="external-link"><code>vignettes/Statistics.Rmd</code></a></small>
      <div class="d-none name"><code>Statistics.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="statistical-tests">STATISTICAL TESTS<a class="anchor" aria-label="anchor" href="#statistical-tests"></a>
</h2>
<p>Statistical tests are used to test assertions about populations. The aim is to determine whether there is enough evidence to <em>reject</em> a null hypothesis. This is shown by way of p-values.</p>
<p><a href="https://shiny.rit.albany.edu/stat/sampdist/" class="external-link">How it works for continuous data?</a></p>
<p><a href="https://rpsychologist.com/pvalue/" class="external-link">How to interpret p-value?</a></p>
<p>For normal continuous data with one or two groups of interest, the t-test (paired or unpaired) is used to compare means. For non-normal data, non-parametric tests such as the Wilcoxon Test is used that compares ranks. For three or more groups, the ANOVA method (for normal data) compares the means with the help of variance calculations between groups and within groups. and Kruskal-Wallis test (for non-normal data) to compare ranks for non-normal data for calculations between groups and within groups.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2</span> 3.3.6     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr  </span> 0.3.4</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble </span> 3.1.7     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr  </span> 1.0.9</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr  </span> 1.2.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr</span> 1.4.0</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr  </span> 2.1.2     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats</span> 0.5.1</span>
<span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span>
<span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="http://openintrostat.github.io/openintro/" class="external-link">"openintro"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"openintro"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hip</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"../inst/extdata/hip_data.csv"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">hip</span><span class="op">)</span>
<span class="co">#&gt;        id            sex                 age           retired      </span>
<span class="co">#&gt;  Min.   :  1.0   Length:708         Min.   :31.00   Min.   :0.0000  </span>
<span class="co">#&gt;  1st Qu.:177.8   Class :character   1st Qu.:66.00   1st Qu.:0.0000  </span>
<span class="co">#&gt;  Median :354.5   Mode  :character   Median :75.00   Median :1.0000  </span>
<span class="co">#&gt;  Mean   :354.5                      Mean   :73.52   Mean   :0.5709  </span>
<span class="co">#&gt;  3rd Qu.:531.2                      3rd Qu.:82.00   3rd Qu.:1.0000  </span>
<span class="co">#&gt;  Max.   :708.0                      Max.   :99.00   Max.   :1.0000  </span>
<span class="co">#&gt;                                                     NA's   :454     </span>
<span class="co">#&gt;       ohs0            ohs6          ohsdiff          EQ5D0        </span>
<span class="co">#&gt;  Min.   : 0.00   Min.   : 6.00   Min.   :-43.0   Min.   :-0.5940  </span>
<span class="co">#&gt;  1st Qu.:13.00   1st Qu.:33.00   1st Qu.:-26.0   1st Qu.: 0.0550  </span>
<span class="co">#&gt;  Median :20.00   Median :42.00   Median :-19.0   Median : 0.5160  </span>
<span class="co">#&gt;  Mean   :20.03   Mean   :38.63   Mean   :-18.6   Mean   : 0.3804  </span>
<span class="co">#&gt;  3rd Qu.:26.00   3rd Qu.:46.00   3rd Qu.:-12.0   3rd Qu.: 0.6910  </span>
<span class="co">#&gt;  Max.   :46.00   Max.   :48.00   Max.   : 19.0   Max.   : 1.0000  </span>
<span class="co">#&gt;                                                  NA's   :18       </span>
<span class="co">#&gt;      height          weight       satisfaction         bmi         </span>
<span class="co">#&gt;  Min.   :1.080   Min.   : 44.0   Min.   :  0.00   Min.   : 0.0022  </span>
<span class="co">#&gt;  1st Qu.:1.603   1st Qu.: 65.0   1st Qu.: 90.00   1st Qu.:23.4509  </span>
<span class="co">#&gt;  Median :1.660   Median : 74.0   Median :100.00   Median :26.3465  </span>
<span class="co">#&gt;  Mean   :1.667   Mean   : 76.1   Mean   : 89.22   Mean   :26.4614  </span>
<span class="co">#&gt;  3rd Qu.:1.740   3rd Qu.: 86.0   3rd Qu.:100.00   3rd Qu.:30.3692  </span>
<span class="co">#&gt;  Max.   :1.970   Max.   :186.0   Max.   :100.00   Max.   :63.4431  </span>
<span class="co">#&gt;  NA's   :370     NA's   :359     NA's   :52       NA's   :359      </span>
<span class="co">#&gt;   bmi_imputed           ethnic           side              imdscore    </span>
<span class="co">#&gt;  Min.   : 0.00225   Min.   :0.0000   Length:708         Min.   : 0.92  </span>
<span class="co">#&gt;  1st Qu.:23.26808   1st Qu.:0.0000   Class :character   1st Qu.: 7.07  </span>
<span class="co">#&gt;  Median :26.68621   Median :0.0000   Mode  :character   Median :11.07  </span>
<span class="co">#&gt;  Mean   :26.74399   Mean   :0.1501                      Mean   :13.82  </span>
<span class="co">#&gt;  3rd Qu.:30.82529   3rd Qu.:0.0000                      3rd Qu.:18.86  </span>
<span class="co">#&gt;  Max.   :63.44307   Max.   :1.0000                      Max.   :48.05  </span>
<span class="co">#&gt;                     NA's   :355                         NA's   :11</span></code></pre></div>
<p>For categorical data, the chi-squared test shows if the observed values in each sub-category differ to the expected values by chance or not.</p>
<div class="section level3">
<h3 id="two-sample-t-test-or-wilcoxon-rank-tests">Two-sample T-test or Wilcoxon-rank tests<a class="anchor" aria-label="anchor" href="#two-sample-t-test-or-wilcoxon-rank-tests"></a>
</h3>
<p>T-tests or Wilcoxon-rank tests can be used to describe the association between two continuous variables.</p>
<div class="section level4">
<h4 id="unpaired-tests">Unpaired tests<a class="anchor" aria-label="anchor" href="#unpaired-tests"></a>
</h4>
<p>Explore the distributions of ages in men and women</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hip</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sex</span>,<span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">hip</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sex</span>,<span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 369 rows containing non-finite values (stat_boxplot).</span></code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">hip</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">weight</span>, <span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sex</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, fill<span class="op">=</span><span class="va">name</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 727 rows containing non-finite values (stat_boxplot).</span></code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-4-3.png" width="700"></p>
<p>An unpaired t-test looks at whether the means of continuous variables differs between two groups. For example we could see whether there is an association between the average age of men and the average age of women. You can get the means with <code>estimate</code> and the p-value with <code>p.value</code> using the accessor <code>$</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span>
<span class="va">t</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">age</span><span class="op">~</span><span class="va">sex</span>,data<span class="op">=</span><span class="va">hip</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">t</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  age by sex</span>
<span class="co">#&gt; t = 4.5196, df = 578.32, p-value = 7.517e-06</span>
<span class="co">#&gt; alternative hypothesis: true difference in means between group Female and group Male is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  2.228963 5.655140</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean in group Female   mean in group Male </span>
<span class="co">#&gt;             75.05275             71.11070</span>
<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 10</span></span>
<span class="co">#&gt;   estimate estimate1 estimate2 statistic    p.value parameter conf.low conf.high</span>
<span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     3.94      75.1      71.1      4.52 0.000<span style="text-decoration: underline;">007</span>52      578.     2.23      5.66</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 2 more variables: method &lt;chr&gt;, alternative &lt;chr&gt;</span></span>

<span class="va">t</span><span class="op">$</span><span class="va">estimate</span>
<span class="co">#&gt; mean in group Female   mean in group Male </span>
<span class="co">#&gt;             75.05275             71.11070</span>
<span class="va">t</span><span class="op">$</span><span class="va">p.value</span>
<span class="co">#&gt; [1] 7.516598e-06</span></code></pre></div>
<p>This indicates that there is a difference in the mean age of men and women of -3.9420512, and this difference is significant with a p.value of 7.5210^{-6}</p>
<p>The <code>p-value</code> from the t-test can be added to the boxplots using <code>stat_compare_means</code> from the library <code>ggpubr</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span>
<span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sex</span>,<span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html" class="external-link">stat_compare_means</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"t.test"</span><span class="op">)</span></code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>However, check the distribution of age in men and women separately using the <em>histogram</em> and <em>qq-plot</em>. It does not look normally distributed.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">age</span>, fill<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>sample<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, fill<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">geom_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<p>Instead of the t-test, one should use the Wilcoxon rank-sum test.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">w</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">age</span><span class="op">~</span><span class="va">sex</span>,data<span class="op">=</span><span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">w</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  age by sex</span>
<span class="co">#&gt; W = 71138, p-value = 4.889e-06</span>
<span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span>

<span class="va">est</span><span class="op">&lt;-</span><span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>median<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">age</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="va">est</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span>
<span class="co">#&gt;   sex    median</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Female     77</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Male       73</span></code></pre></div>
<p>This indicates that there is a difference in the median age of men and women of -4, and this difference is significant with a p.value of 4.8910^{-6}</p>
<p>Similarly, add the <code>p-value</code> to the boxplots using <code>stat_compare_means</code> from the library <code>ggpubr</code>. The Wilcox-test is the default method, so we do not need to add an argument to the funciton.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sex</span>,<span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html" class="external-link">stat_compare_means</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="paired-tests">Paired tests<a class="anchor" aria-label="anchor" href="#paired-tests"></a>
</h4>
<p>The paired t-test would be used to compare the difference in repeated measures on the same individuals. For example, in the dataset, Performance at baseline and 6-months are given by <code>ohs0</code> and <code>ohs6</code>. Use a paired t-test to analyse the difference in the distributions. Note the extra <code>paired</code> argument in the <code>t.test</code> function. Use the using the accessor <code>$</code> or <code>pull</code> to extract the relevant variables.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">t</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">hip</span><span class="op">$</span><span class="va">ohs0</span>,<span class="va">hip</span><span class="op">$</span><span class="va">ohs6</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">t</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Paired t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  hip$ohs0 and hip$ohs6</span>
<span class="co">#&gt; t = -45.865, df = 707, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: true mean difference is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -19.40091 -17.80813</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean difference </span>
<span class="co">#&gt;       -18.60452</span>

<span class="va">t</span><span class="op">$</span><span class="va">estimate</span>
<span class="co">#&gt; mean difference </span>
<span class="co">#&gt;       -18.60452</span>
<span class="va">t</span><span class="op">$</span><span class="va">p.value</span>
<span class="co">#&gt; [1] 4.551803e-214</span></code></pre></div>
<p>This indicates that there is a difference in the mean performance between baseline and 6 months of -18.6045198, and this difference is highly significant.</p>
<p>Calculate the difference between the performances at the 2 time points and use a histogram to represent the distribution. Use <code>geom_vline</code> to draw a dotted line at 0 to represent the <em>Null distribution</em>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diff<span class="op">=</span><span class="va">ohs6</span><span class="op">-</span><span class="va">ohs0</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> 
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>The non-parametric version is the Wilcoxon signed-rank test, and this is also significant.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">w</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">hip</span><span class="op">$</span><span class="va">ohs0</span>,<span class="va">hip</span><span class="op">$</span><span class="va">ohs6</span>,paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">w</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Wilcoxon signed rank test with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  hip$ohs0 and hip$ohs6</span>
<span class="co">#&gt; V = 2850, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span>

<span class="va">w</span><span class="op">$</span><span class="va">p.value</span>
<span class="co">#&gt; [1] 2.184776e-111</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="anova-analysis-of-variance">ANOVA (Analysis of Variance)<a class="anchor" aria-label="anchor" href="#anova-analysis-of-variance"></a>
</h3>
<p>A one-way ANOVA can be used when there are more than two groups.</p>
<p>For example split the variable of satisfaction into 3 groups.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hip</span><span class="op">&lt;-</span><span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>satisfaction.cat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">satisfaction</span><span class="op">&lt;</span><span class="fl">80</span>,<span class="st">"Low"</span>,<span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">satisfaction</span>,<span class="fl">80</span>,<span class="fl">90</span><span class="op">)</span>,<span class="st">"Medium"</span>,<span class="st">"High"</span><span class="op">)</span><span class="op">)</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Low"</span>,<span class="st">"Medium"</span>,<span class="st">"High"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">satisfaction.cat</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; .</span>
<span class="co">#&gt;    Low Medium   High </span>
<span class="co">#&gt;     87    185    384</span></code></pre></div>
<p>Run an ANOVA to test the relationship between age and satisfaction.cat</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">age</span><span class="op">~</span><span class="va">satisfaction.cat</span>,data<span class="op">=</span><span class="va">hip</span><span class="op">)</span>

<span class="va">s</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>

<span class="va">s</span>
<span class="co">#&gt;                   Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; satisfaction.cat   2    396   198.2   1.482  0.228</span>
<span class="co">#&gt; Residuals        653  87324   133.7               </span>
<span class="co">#&gt; 52 observations deleted due to missingness</span></code></pre></div>
<p>This suggests that there is very little evidence that satisfaction groups are different with respect to age. with a p-value of 0.228</p>
</div>
<div class="section level3">
<h3 id="chi-squared-test">Chi-squared test<a class="anchor" aria-label="anchor" href="#chi-squared-test"></a>
</h3>
<p>To look at the association between two categorical variables we can perform a chi squared test Study the relationshipo between sex and satisfaction.cat using a contingency table and a bar plot.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">satisfaction.cat</span><span class="op">)</span><span class="op">)</span>  <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">sex</span>,fill<span class="op">=</span><span class="va">satisfaction.cat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"dodge"</span><span class="op">)</span></code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">t</span> <span class="op">&lt;-</span> <span class="va">hip</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sex</span>,<span class="va">satisfaction.cat</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">t</span>
<span class="co">#&gt;         satisfaction.cat</span>
<span class="co">#&gt; sex      Low Medium High</span>
<span class="co">#&gt;   Female  55    116  233</span>
<span class="co">#&gt;   Male    32     69  150</span></code></pre></div>
<p>Use <code>prop.table</code> and <code>geom_bar(stat="identity")</code> to report the relative frequencies of satisfaction between the sexes.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="va">t</span>, margin <span class="op">=</span><span class="fl">1</span><span class="op">)</span>

<span class="va">p</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sex</span>,y<span class="op">=</span><span class="va">Freq</span>,fill<span class="op">=</span><span class="va">satisfaction.cat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span></code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Test this relationship using the <code>chi.test</code> command on the contingency table.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">c</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html" class="external-link">chisq.test</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>
<span class="va">c</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson's Chi-squared test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  t</span>
<span class="co">#&gt; X-squared = 0.28454, df = 2, p-value = 0.8674</span></code></pre></div>
<p>The relative risks are close to 1. Alongwith the test, this indicates that there is very little evidence of a relationship between satisfaction.cat and sex, with a p.value of 0.8674.</p>
</div>
<div class="section level3">
<h3 id="exercise">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Check whether there is a difference in the performance at baseline <code>ohs0</code> between the males and females. Study the distributions and decide which test to use.</p></li>
<li><p>We used an ANOVA to study the distribution of satisfaction.cat and age. Check the distribution of age over the 3 satisfaction.cat groups. Does it pass normality assumptions? If you are unsure, use Kruskal-Wallis test. Hint you can get information using <code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">?kruskal.test</a></code>.</p></li>
<li><p>Use ANOVA or Kruskal-Wallis test to check if there is an association between baseline ohs0 and satisfaction.cat groups.</p></li>
<li><p>Create a table of retired against satisfaction groups. Does the chi-square test show an association between the two?</p></li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="linear-associations">Linear associations<a class="anchor" aria-label="anchor" href="#linear-associations"></a>
</h2>
<p>The data we’re working with is in the openintro package and it’s called <code>hfi</code>, short for Human Freedom Index.</p>
<p>What type of plot would you use to display the relationship between the personal freedom score, <code>pf_score</code>, and <code>pf_expression_control</code>? Plot this relationship using the variable <code>pf_expression_control</code> as the predictor. Does the relationship look linear? If you knew a country’s <code>pf_expression_control</code>, or its score out of 10, with 0 being the most, of political pressures and controls on media content, would you be comfortable using a linear model to predict the personal freedom score?</p>
<p>If the relationship looks linear, we can quantify the strength of the relationship with the correlation coefficient.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">hfi_2016</span> <span class="op">&lt;-</span> <span class="va">hfi</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2016</span><span class="op">)</span>


<span class="va">hfi_2016</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">pf_expression_control</span>, <span class="va">pf_score</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Statistics_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">


<span class="va">hfi_2016</span> <span class="op"><a href="https://rpkgs.datanovia.com/ggpubr/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">pf_expression_control</span>, <span class="va">pf_score</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 1</span></span>
<span class="co">#&gt;   `cor(pf_expression_control, pf_score)`</span>
<span class="co">#&gt;                                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                                  0.845</span></code></pre></div>
<p><span style="font-size:4em;">Correlation is not causation!!! </span></p>
<p><img src="https://images.squarespace-cdn.com/content/v1/5bfc8dbab40b9d7dd9054f41/1635480696871-Y3HAE2GV9EUJB5P7UANT/FCUQhjvVUAUAPlh.jpg?format=750w?raw=true" width="70%"></p>
</div>
<div class="section level2">
<h2 id="linear-regression">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">pf_score</span> <span class="op">~</span> <span class="va">pf_expression_control</span>, data <span class="op">=</span> <span class="va">hfi_2016</span><span class="op">)</span></code></pre></div>
<p>The first argument in the function <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> is a formula that takes the form <code>y ~ x</code>.</p>
<p>The output of <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> is an object that contains all of the information we need about the linear model that was just fit. We can access this information using the <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span>
<span class="co">#&gt;   term                  estimate std.error statistic  p.value</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> (Intercept)              4.28     0.149       28.8 4.23<span style="color: #949494;">e</span><span style="color: #BB0000;">-65</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> pf_expression_control    0.542    0.027<span style="text-decoration: underline;">1</span>      20.0 2.31<span style="color: #949494;">e</span><span style="color: #BB0000;">-45</span></span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = pf_score ~ pf_expression_control, data = hfi_2016)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; -2.65911 -0.49491  0.04574  0.52073  1.59064 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                       Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)             4.2838     0.1490   28.75   &lt;2e-16 ***</span>
<span class="co">#&gt; pf_expression_control   0.5419     0.0271   19.99   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.7993 on 160 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.7141, Adjusted R-squared:  0.7123 </span>
<span class="co">#&gt; F-statistic: 399.7 on 1 and 160 DF,  p-value: &lt; 2.2e-16</span></code></pre></div>
<p>Let’s consider this output piece by piece. First, the formula used to describe the model is shown at the top, in what’s displayed as the “Call”. After the formula you find the five-number summary of the residuals. The “Coefficients” table shown next is key; its first column displays the linear model’s y-intercept and the coefficient of <code>pf_expression_control</code>. With this table, we can write down the least squares regression line for the linear model:</p>
<p><span class="math display">\[
  \hat{y} = 4.28 + 0.542 \times pf\_expression\_control
\]</span></p>
<p>This equation tells us two things:</p>
<ul>
<li>For countries with a <code>pf_expression_control</code> of 0 (those with the largest amount of political pressure on media content), we expect their mean personal freedom score to be 4.28.</li>
<li>For every 1 unit increase in <code>pf_expression_control</code>, we expect a country’s mean personal freedom score to increase 0.542 units.</li>
</ul>
<p>We can assess model fit using <span class="math inline">\(R^2\)</span>, the proportion of variability in the response variable that is explained by the explanatory variable. We use the <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> function to access this information.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 12</span></span>
<span class="co">#&gt;   r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC</span>
<span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0.714         0.712 0.799      400. 2.31<span style="color: #949494;">e</span><span style="color: #BB0000;">-45</span>     1  -<span style="color: #BB0000;">193.</span>  391.  400.</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</span></span></code></pre></div>
<p>For this model, 71.4% of the variability in <code>pf_score</code> is explained by <code>pf_expression_control</code>.</p>
<div class="section level3">
<h3 id="prediction-and-prediction-errors">Prediction and prediction errors<a class="anchor" aria-label="anchor" href="#prediction-and-prediction-errors"></a>
</h3>
<p>Let’s create a scatterplot with the least squares line for <code>m1</code> laid on top.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hfi_2016</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pf_expression_control</span>, y <span class="op">=</span> <span class="va">pf_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="Statistics_files/figure-html/reg-with-line-1.png" width="700"></p>
<p>Here, we are literally adding a layer on top of our plot. <code>geom_smooth</code> creates the line by fitting a linear model. It can also show us the standard error <code>se</code> associated with our line, but we’ll suppress that for now.</p>
<p>This line can be used to predict <span class="math inline">\(y\)</span> at any value of <span class="math inline">\(x\)</span>. When predictions are made for values of <span class="math inline">\(x\)</span> that are beyond the range of the observed data, it is referred to as <em>extrapolation</em> and is not usually recommended. However, predictions made within the range of the data are more reliable. They’re also used to compute the residuals.</p>
</div>
<div class="section level3">
<h3 id="model-diagnostics">Model diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a>
</h3>
<p>To assess whether the linear model is reliable, we need to check for (1) linearity, (2) nearly normal residuals, and (3) constant variability.</p>
<p>In order to do these checks we need access to the fitted (predicted) values and the residuals. We can use the <code><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment()</a></code> function to calculate these.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m1_aug</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></code></pre></div>
<p>###Linearity###</p>
<p>You already checked if the relationship between <code>pf_score</code> and <code>pf_expression_control</code> is linear using a scatterplot. We should also verify this condition with a plot of the residuals vs. fitted (predicted) values.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m1_aug</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.fitted</span>, y <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Fitted values"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span></code></pre></div>
<p><img src="Statistics_files/figure-html/residuals-1.png" width="700"></p>
<p>Notice here that <code>m1</code> can also serve as a data set because stored within it are the fitted values (<span class="math inline">\(\hat{y}\)</span>) and the residuals. Also note that we’re getting fancy with the code here. After creating the scatterplot on the first layer (first line of code), we overlay a red horizontal dashed line at <span class="math inline">\(y = 0\)</span> (to help us check whether the residuals are distributed around 0), and we also rename the axis labels to be more informative.</p>
<p>Is there any apparent pattern in the residuals plot? What does this indicate about the linearity of the relationship between the two variables?</p>
<p>###Nearly normal residuals###</p>
<p>To check this condition, we can look at a histogram of the residuals.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m1_aug</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Residuals"</span><span class="op">)</span></code></pre></div>
<p><img src="Statistics_files/figure-html/hist-res-1.png" width="700"></p>
<p>Based on the histogram, does the nearly normal residuals condition appear to be violated? Why or why not?</p>
<div class="section level4">
<h4 id="constant-variability">Constant variability<a class="anchor" aria-label="anchor" href="#constant-variability"></a>
</h4>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">m1_aug</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.fitted</span>, y <span class="op">=</span> <span class="va">.std.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Fitted values"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"SD Residuals"</span><span class="op">)</span></code></pre></div>
<p><img src="Statistics_files/figure-html/var-res-1.png" width="700"></p>
<p>Based on the residuals vs. fitted plot, does the constant variability condition appear to be violated? Why or why not?</p>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="exercises">EXERCISES<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h3>
<p>1. Fit a new model that uses <code>pf_expression_control</code> to predict <code>hf_score</code>, or the total human freedom score. Using the estimates from the R output, write the equation of the regression line. What does the slope tell us in the context of the relationship between human freedom and the amount of political pressure on media content?</p>
<p>2. If someone saw the least squares regression line and not the actual data, how would they predict a country’s <code>hf_score</code> for one with a 3 rating for <code>pf_expression_control</code>? Is this an overestimate or an underestimate, and by how much? In other words, what is the residual for this prediction?</p>
<p>3. How does this relationship compare to the relationship between <code>pf_score</code> and <code>pf_expression_control</code>? Use the <span class="math inline">\(R^2\)</span> values from the two model summaries to compare. Does your <code>pf_expression_control</code> seem to predict <code>hf_score</code> better? Why or why not?</p>
<p>4. Check the model diagnostics using appropriate visualisations and evaluate if the model conditions have been met.</p>
<p>5. Pick another pair of variables of interest and visualise the relationship between them. Do you find the relationship surprising or is it what you expected. Discuss why you were interested in these variables and why you were/were not surprised by the relationship you observed.</p>
</div>
</div>
<div class="section level2">
<h2 id="multivariable-regression">MULTIVARIABLE REGRESSION<a class="anchor" aria-label="anchor" href="#multivariable-regression"></a>
</h2>
<p><img src="https://www.researchgate.net/profile/Ian-Wilson-30/publication/299415540/figure/fig1/AS:349820582678528@1460415134350/Possible-relationships-of-a-covariate-and-a-confounder-to-an-exposure-variable-and-an_W640.jpg?raw=true" width="70%"></p>
<p><a href="https://www.researchgate.net/publication/299415540_Confounding_and_causation_in_the_epidemiology_of_lead" class="external-link">Source</a></p>
<div class="section level3">
<h3 id="exercises-1">EXERCISES<a class="anchor" aria-label="anchor" href="#exercises-1"></a>
</h3>
<p>1. Copy your model from the previous exercise that uses <code>pf_expression_control</code> to predict Human Freedom or <code>hf_score</code>. Using the <code>tidy</code> command, what does the slope tell us in the context of the relationship between human freedom and expression control in the country?</p>
<p>2. Add region to the model from Q1 using <code>lm(hf_score ~ pf_expression_control + region, data = hfi_2016)</code>. What do you notice about the slope between human freedom and expression control? How has it changed from the previous model. Do you think region is a confounder, and think about reasons why this might be so?</p>
<p>3. Compare the <span class="math inline">\(R^2\)</span> for the 2 models from Q1 and Q2. Is there an increase by adding region? Think about the definition of <span class="math inline">\(R^2\)</span>. What does this mean in this context?</p>
<p>4. Fit a new model that uses <code>ef_money</code> or monetary measure to predict <code>hf_score</code>. What does the slope tell us in the context of the relationship between human freedom and the economy in the country?</p>
<p>5. Again add region to the model from Q4. Compare the slope and <span class="math inline">\(R^2\)</span> with the model from Q4.</p>
<p>6. Finally fit a model with <code>ef_money</code> and <code>pf_expression_control</code> as exposures and <code>hf_score</code> as outcome. Compare the slope and <span class="math inline">\(R^2\)</span> from the models from Q1. Could <code>ef_money</code> be a confounder?</p>
<p>7. Use a linear regression model (and scatter plot) with <code>ef_money</code> as exposure and <code>pf_expression_control</code> as outcome, to study whether <code>ef_money</code> has an association with <code>pf_expression_control</code> as well. This might validate our finding that <code>ef_money</code> is a confounder between <code>pf_expression_control</code> as exposure and <code>hf_score</code> as outcome from Q6.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Reka Toth, Rajbir Nath Batra.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
